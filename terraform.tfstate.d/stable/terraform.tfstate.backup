{
  "version": 4,
  "terraform_version": "1.13.3",
  "serial": 20,
  "lineage": "6f58d66c-17e6-3e22-86bc-6c30da36c171",
  "outputs": {},
  "resources": [
    {
      "mode": "managed",
      "type": "aws_bedrockagent_flow",
      "name": "triage",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:bedrock:eu-west-2:261219435789:flow/RU8U3PTJF8",
            "created_at": "2025-10-27T13:30:34Z",
            "customer_encryption_key_arn": null,
            "definition": [
              {
                "connection": [
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "document",
                            "target_input": "user_input"
                          }
                        ]
                      }
                    ],
                    "name": "FlowInputNodeFlowInputNode0ToAgent_1PromptsNode0",
                    "source": "FlowInputNode",
                    "target": "Triage",
                    "type": "Data"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "modelCompletion",
                            "target_input": "document"
                          }
                        ]
                      }
                    ],
                    "name": "Agent_1PromptsNode0ToFlowOutputNodeFlowOutputNode0",
                    "source": "Triage",
                    "target": "FlowOutputNode",
                    "type": "Data"
                  }
                ],
                "node": [
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [
                          {}
                        ],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [],
                    "name": "FlowInputNode",
                    "output": [
                      {
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "type": "Input"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [
                          {
                            "guardrail_configuration": [],
                            "source_configuration": [
                              {
                                "inline": [],
                                "resource": [
                                  {
                                    "prompt_arn": "arn:aws:bedrock:eu-west-2:261219435789:prompt/SMKVHYRB7Q"
                                  }
                                ]
                              }
                            ]
                          }
                        ],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "user_input",
                        "type": "String"
                      }
                    ],
                    "name": "Triage",
                    "output": [
                      {
                        "name": "modelCompletion",
                        "type": "String"
                      }
                    ],
                    "type": "Prompt"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [
                          {}
                        ],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "name": "FlowOutputNode",
                    "output": [],
                    "type": "Output"
                  }
                ]
              }
            ],
            "description": null,
            "execution_role_arn": "arn:aws:iam::261219435789:role/bedrock-execution-role-stable",
            "id": "RU8U3PTJF8",
            "name": "triage-flow-stable",
            "region": "eu-west-2",
            "status": "NotPrepared",
            "tags": null,
            "tags_all": {},
            "timeouts": null,
            "updated_at": "2025-10-27T18:01:23Z",
            "version": "DRAFT"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_prompt.triage_prompt",
            "aws_iam_role.bedrock_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_prompt",
      "name": "triage_prompt",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:bedrock:eu-west-2:261219435789:prompt/SMKVHYRB7Q",
            "created_at": "2025-10-27T18:01:16Z",
            "customer_encryption_key_arn": null,
            "default_variant": "triage_variant",
            "description": "This is an entrypoint prompt to triage the users initial input",
            "id": "SMKVHYRB7Q",
            "name": "triage_prompt_stable",
            "region": "eu-west-2",
            "tags": null,
            "tags_all": {},
            "updated_at": "2025-10-27T18:01:16Z",
            "variant": [
              {
                "additional_model_request_fields": null,
                "gen_ai_resource": [],
                "inference_configuration": [
                  {
                    "text": [
                      {
                        "max_tokens": 2048,
                        "stop_sequences": [
                          "User:"
                        ],
                        "temperature": 0,
                        "top_p": 0.8999999761581421
                      }
                    ]
                  }
                ],
                "metadata": [],
                "model_id": "amazon.nova-lite-v1:0",
                "name": "triage_variant",
                "template_configuration": [
                  {
                    "chat": [
                      {
                        "input_variable": [
                          {
                            "name": "user_input"
                          }
                        ],
                        "message": [
                          {
                            "content": [
                              {
                                "cache_point": [],
                                "text": "{{user_input}}"
                              }
                            ],
                            "role": "user"
                          }
                        ],
                        "system": [
                          {
                            "cache_point": [],
                            "text": "\u003ccontext\u003e\nYou are tasked with assessing whether the person you are in conversation with is\neligable for one or more benefits. You can ask the person as many questions as are needed to\nassess their eligability.\n\nYou must only use the links provided in this context block to understand the criteria for eligability.\n\nThese benefits, are:\n* Blue Badge: https://www.gov.uk/government/publications/blue-badge-can-i-get-one/can-i-get-a-blue-badge\n\u003c/context\u003e\n"
                          }
                        ],
                        "tool_configuration": []
                      }
                    ],
                    "text": []
                  }
                ],
                "template_type": "CHAT"
              }
            ],
            "version": "DRAFT"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "bedrock_agent_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::261219435789:role/bedrock-agent-role-stable",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-27T13:30:22Z",
            "description": "",
            "force_detach_policies": false,
            "id": "bedrock-agent-role-stable",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AmazonBedrockLimitedAccess"
            ],
            "max_session_duration": 3600,
            "name": "bedrock-agent-role-stable",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATZUPEIUG7OHNOEI3B"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "bedrock-agent-role-stable"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "bedrock_execution_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::261219435789:role/bedrock-execution-role-stable",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-27T13:30:23Z",
            "description": "",
            "force_detach_policies": false,
            "id": "bedrock-execution-role-stable",
            "inline_policy": [
              {
                "name": "bedrock-execution-policy-stable",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeAgent\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AmazonBedrockLimitedAccess"
            ],
            "max_session_duration": 3600,
            "name": "bedrock-execution-role-stable",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATZUPEIUGZPROCZ7N7"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "bedrock-execution-role-stable"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "bedrock_execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bedrock-execution-role-stable:bedrock-execution-policy-stable",
            "name": "bedrock-execution-policy-stable",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeAgent\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}",
            "role": "bedrock-execution-role-stable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "bedrock-execution-policy-stable",
            "role": "bedrock-execution-role-stable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "bedrock_agent_policy_limited_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bedrock-agent-role-stable/arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-agent-role-stable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-agent-role-stable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_agent_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "bedrock_execution_policy_limited_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bedrock-execution-role-stable/arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-execution-role-stable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-execution-role-stable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_execution_role"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
