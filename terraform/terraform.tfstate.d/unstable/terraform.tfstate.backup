{
  "version": 4,
  "terraform_version": "1.13.4",
  "serial": 54,
  "lineage": "c0a8b4dd-b41d-bcd2-0e4b-c0f436df2655",
  "outputs": {},
  "resources": [
    {
      "mode": "data",
      "type": "aws_ecr_image",
      "name": "frontend_app",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "sha256:7758b7b250a06f359207787f24475cdcf4431cecd15154840c43bc705883cfb0",
            "image_digest": "sha256:7758b7b250a06f359207787f24475cdcf4431cecd15154840c43bc705883cfb0",
            "image_pushed_at": 1761929952,
            "image_size_in_bytes": 67710447,
            "image_tag": "unstable",
            "image_tags": [
              "unstable"
            ],
            "image_uri": "261219435789.dkr.ecr.eu-west-2.amazonaws.com/gds-eligability-frontend-repo@sha256:7758b7b250a06f359207787f24475cdcf4431cecd15154840c43bc705883cfb0",
            "most_recent": null,
            "region": "eu-west-2",
            "registry_id": "261219435789",
            "repository_name": "gds-eligability-frontend-repo"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_apprunner_service",
      "name": "frontend_app",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "status": "tainted",
          "schema_version": 0,
          "attributes": {
            "arn": null,
            "auto_scaling_configuration_arn": null,
            "encryption_configuration": [],
            "health_check_configuration": [
              {
                "healthy_threshold": 1,
                "interval": 5,
                "path": "/health",
                "protocol": "HTTP",
                "timeout": 2,
                "unhealthy_threshold": 5
              }
            ],
            "id": "arn:aws:apprunner:eu-west-2:261219435789:service/gds-eligability-frontend-app-unstable/591c88caea6a41cc906770ce1df9f3ea",
            "instance_configuration": [
              {
                "cpu": "1024",
                "instance_role_arn": "arn:aws:iam::261219435789:role/gds-eligability-frontend-app-service-unstable",
                "memory": "2048"
              }
            ],
            "network_configuration": [
              {
                "egress_configuration": [],
                "ingress_configuration": [
                  {
                    "is_publicly_accessible": false
                  }
                ],
                "ip_address_type": "IPV4"
              }
            ],
            "observability_configuration": [],
            "region": "eu-west-2",
            "service_id": null,
            "service_name": "gds-eligability-frontend-app-unstable",
            "service_url": null,
            "source_configuration": [
              {
                "authentication_configuration": [
                  {
                    "access_role_arn": "arn:aws:iam::261219435789:role/gds-eligability-frontend-app-ecr-unstable",
                    "connection_arn": ""
                  }
                ],
                "auto_deployments_enabled": true,
                "code_repository": [],
                "image_repository": [
                  {
                    "image_configuration": [
                      {
                        "port": "8080",
                        "runtime_environment_secrets": null,
                        "runtime_environment_variables": {
                          "AWS_REGION": "eu-west-2",
                          "BEDROCK_FLOW_ALIAS_ID": "XC4VHFA93K",
                          "BEDROCK_FLOW_ID": "RU8U3PTJF8"
                        },
                        "start_command": ""
                      }
                    ],
                    "image_identifier": "261219435789.dkr.ecr.eu-west-2.amazonaws.com/gds-eligability-frontend-repo@sha256:7758b7b250a06f359207787f24475cdcf4431cecd15154840c43bc705883cfb0",
                    "image_repository_type": "ECR"
                  }
                ]
              }
            ],
            "status": null,
            "tags": null,
            "tags_all": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.frontend_app_ecr",
            "aws_iam_role.frontend_app_service",
            "data.aws_ecr_image.frontend_app"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent",
      "name": "eligability_agent",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_arn": "arn:aws:bedrock:eu-west-2:261219435789:agent/PLLDWRK7TH",
            "agent_collaboration": "DISABLED",
            "agent_id": "PLLDWRK7TH",
            "agent_name": "gds_eligability_terraform_sandbox_eligability_agent-unstable",
            "agent_resource_role_arn": "arn:aws:iam::261219435789:role/bedrock-agent-role-unstable",
            "agent_version": null,
            "customer_encryption_key_arn": null,
            "description": null,
            "foundation_model": "amazon.nova-lite-v1:0",
            "guardrail_configuration": null,
            "id": "PLLDWRK7TH",
            "idle_session_ttl_in_seconds": 600,
            "instruction": "\u003ccontext\u003e\nYou are tasked with assessing whether the person you are in conversation with is\neligable for one or more benefits.\n\u003crules\u003e\n* You can ask the person as many questions as are needed to\nassess their eligability, but must only ask one question at a ti:me.\n* Don't provide links.\n* Always be polite\n* Only ask questions relating to the person you are talking to\n\u003c/rules\u003e\n\nYou must only use the links provided in this context block to understand the criteria for eligability.\n\nThese benefits, are:\n* Blue Badge: https://www.gov.uk/government/publications/blue-badge-can-i-get-one/can-i-get-a-blue-badge\n\u003c/context\u003e\n",
            "memory_configuration": null,
            "prepare_agent": true,
            "prepared_at": "2025-10-29T11:20:24Z",
            "prompt_override_configuration": [
              {
                "override_lambda": null,
                "prompt_configurations": null
              }
            ],
            "region": "eu-west-2",
            "skip_resource_in_use_check": false,
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_iam_role.bedrock_agent_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_agent_alias",
      "name": "eligability_alias_for_prompts",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "agent_alias_arn": "arn:aws:bedrock:eu-west-2:261219435789:agent-alias/PLLDWRK7TH/LACOHDAWDL",
            "agent_alias_id": "LACOHDAWDL",
            "agent_alias_name": "eligability-alias-for-prompts-unstable",
            "agent_id": "PLLDWRK7TH",
            "description": "Alias to allow linkage between eligability agent and prompts",
            "id": "LACOHDAWDL,PLLDWRK7TH",
            "region": "eu-west-2",
            "routing_configuration": [
              {
                "agent_version": "1",
                "provisioned_throughput": null
              }
            ],
            "tags": null,
            "tags_all": {},
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.eligability_agent",
            "aws_iam_role.bedrock_agent_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_bedrockagent_flow",
      "name": "triage",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:bedrock:eu-west-2:261219435789:flow/5J3408MJSB",
            "created_at": "2025-10-27T15:43:37Z",
            "customer_encryption_key_arn": null,
            "definition": [
              {
                "connection": [
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "document",
                            "target_input": "agentInputText"
                          }
                        ]
                      }
                    ],
                    "name": "FlowInputNodeFlowInputNode0ToAgent_1PromptsNode0",
                    "source": "FlowInputNode",
                    "target": "Triage",
                    "type": "Data"
                  },
                  {
                    "configuration": [
                      {
                        "conditional": [],
                        "data": [
                          {
                            "source_output": "agentResponse",
                            "target_input": "document"
                          }
                        ]
                      }
                    ],
                    "name": "Agent_1PromptsNode0ToFlowOutputNodeFlowOutputNode0",
                    "source": "Triage",
                    "target": "FlowOutputNode",
                    "type": "Data"
                  }
                ],
                "node": [
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [
                          {}
                        ],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [],
                    "name": "FlowInputNode",
                    "output": [
                      {
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "type": "Input"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [
                          {
                            "agent_alias_arn": "arn:aws:bedrock:eu-west-2:261219435789:agent-alias/PLLDWRK7TH/LACOHDAWDL"
                          }
                        ],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "agentInputText",
                        "type": "String"
                      },
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "promptAttributes",
                        "type": "Object"
                      },
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "sessionAttributes",
                        "type": "Object"
                      }
                    ],
                    "name": "Triage",
                    "output": [
                      {
                        "name": "agentResponse",
                        "type": "String"
                      }
                    ],
                    "type": "Agent"
                  },
                  {
                    "configuration": [
                      {
                        "agent": [],
                        "collector": [],
                        "condition": [],
                        "inline_code": [],
                        "input": [],
                        "iterator": [],
                        "knowledge_base": [],
                        "lambda_function": [],
                        "lex": [],
                        "output": [
                          {}
                        ],
                        "prompt": [],
                        "retrieval": [],
                        "storage": []
                      }
                    ],
                    "input": [
                      {
                        "category": null,
                        "expression": "$.data",
                        "name": "document",
                        "type": "String"
                      }
                    ],
                    "name": "FlowOutputNode",
                    "output": [],
                    "type": "Output"
                  }
                ]
              }
            ],
            "description": null,
            "execution_role_arn": "arn:aws:iam::261219435789:role/bedrock-execution-role-unstable",
            "id": "5J3408MJSB",
            "name": "triage-flow-unstable",
            "region": "eu-west-2",
            "status": "Prepared",
            "tags": null,
            "tags_all": {},
            "timeouts": null,
            "updated_at": "2025-10-28T11:53:06Z",
            "version": "DRAFT"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "dependencies": [
            "aws_bedrockagent_agent.eligability_agent",
            "aws_bedrockagent_agent_alias.eligability_alias_for_prompts",
            "aws_iam_role.bedrock_agent_role",
            "aws_iam_role.bedrock_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_ecr_repository",
      "name": "frontend_app",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": []
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "bedrock_agent_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::261219435789:role/bedrock-agent-role-unstable",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-27T15:43:37Z",
            "description": "",
            "force_detach_policies": false,
            "id": "bedrock-agent-role-unstable",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AmazonBedrockFullAccess"
            ],
            "max_session_duration": 3600,
            "name": "bedrock-agent-role-unstable",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATZUPEIUG7NGZE4K4N"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "bedrock-agent-role-unstable"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "bedrock_execution_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::261219435789:role/bedrock-execution-role-unstable",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"bedrock.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-27T15:43:37Z",
            "description": "",
            "force_detach_policies": false,
            "id": "bedrock-execution-role-unstable",
            "inline_policy": [
              {
                "name": "bedrock-execution-policy-unstable",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeAgent\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AmazonBedrockFullAccess"
            ],
            "max_session_duration": 3600,
            "name": "bedrock-execution-role-unstable",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATZUPEIUGZXTWHS6H3"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "bedrock-execution-role-unstable"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "frontend_app_ecr",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::261219435789:role/gds-eligability-frontend-app-ecr-unstable",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"build.apprunner.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-31T15:12:47Z",
            "description": "",
            "force_detach_policies": false,
            "id": "gds-eligability-frontend-app-ecr-unstable",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/service-role/AWSAppRunnerServicePolicyForECRAccess"
            ],
            "max_session_duration": 3600,
            "name": "gds-eligability-frontend-app-ecr-unstable",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATZUPEIUGRKIHRJSFI"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "gds-eligability-frontend-app-ecr-unstable"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "frontend_app_service",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::261219435789:role/gds-eligability-frontend-app-service-unstable",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"tasks.apprunner.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-10-29T11:59:47Z",
            "description": "",
            "force_detach_policies": false,
            "id": "gds-eligability-frontend-app-service-unstable",
            "inline_policy": [
              {
                "name": "terraform-20251031151248261200000001",
                "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeFlow\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}"
              }
            ],
            "managed_policy_arns": [
              "arn:aws:iam::aws:policy/AWSAppRunnerFullAccess"
            ],
            "max_session_duration": 3600,
            "name": "gds-eligability-frontend-app-service-unstable",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {},
            "unique_id": "AROATZUPEIUGYKMG44HO7"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "gds-eligability-frontend-app-service-unstable"
          },
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "bedrock_execution_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bedrock-execution-role-unstable:bedrock-execution-policy-unstable",
            "name": "bedrock-execution-policy-unstable",
            "name_prefix": "",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeAgent\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}",
            "role": "bedrock-execution-role-unstable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "bedrock-execution-policy-unstable",
            "role": "bedrock-execution-role-unstable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy",
      "name": "frontend_app_service_bedrock",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "gds-eligability-frontend-app-service-unstable:terraform-20251031151248261200000001",
            "name": "terraform-20251031151248261200000001",
            "name_prefix": "terraform-",
            "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Action\":[\"bedrock:InvokeFlow\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}]}",
            "role": "gds-eligability-frontend-app-service-unstable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "name": "terraform-20251031151248261200000001",
            "role": "gds-eligability-frontend-app-service-unstable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.frontend_app_service"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "bedrock_agent_policy_limited_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bedrock-agent-role-unstable/arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-agent-role-unstable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-agent-role-unstable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_agent_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "bedrock_execution_policy_limited_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "bedrock-execution-role-unstable/arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-execution-role-unstable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "policy_arn": "arn:aws:iam::aws:policy/AmazonBedrockFullAccess",
            "role": "bedrock-execution-role-unstable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.bedrock_execution_role"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "frontend_app_ecr_role_ecr",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "gds-eligability-frontend-app-ecr-unstable/arn:aws:iam::aws:policy/service-role/AWSAppRunnerServicePolicyForECRAccess",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSAppRunnerServicePolicyForECRAccess",
            "role": "gds-eligability-frontend-app-ecr-unstable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "policy_arn": "arn:aws:iam::aws:policy/service-role/AWSAppRunnerServicePolicyForECRAccess",
            "role": "gds-eligability-frontend-app-ecr-unstable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.frontend_app_ecr"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "frontend_app_service_apprunner",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "gds-eligability-frontend-app-service-unstable/arn:aws:iam::aws:policy/AWSAppRunnerFullAccess",
            "policy_arn": "arn:aws:iam::aws:policy/AWSAppRunnerFullAccess",
            "role": "gds-eligability-frontend-app-service-unstable"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "identity": {
            "account_id": "261219435789",
            "policy_arn": "arn:aws:iam::aws:policy/AWSAppRunnerFullAccess",
            "role": "gds-eligability-frontend-app-service-unstable"
          },
          "private": "bnVsbA==",
          "dependencies": [
            "aws_iam_role.frontend_app_service"
          ]
        }
      ]
    }
  ],
  "check_results": null
}
